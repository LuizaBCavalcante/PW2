<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/layout :: layout(~{::head}, ~{::main}, 'Meu Carrinho')}">
<head th:replace="~{fragments/head :: head(~{}, ~{::title})}">
    <title>Carrinho</title>
</head>
<main>
    <div class="container mt-4">

        <table class="table table-striped table-hover mt-3">
            <thead class="table-dark">
            <tr>
                <th>Produto</th>
                <th>Preço Unit.</th>
                <th>Qtd</th>
                <th>Subtotal</th>
                <th>Ação</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="item, stat : ${venda.itemVendas}">
                <td th:text="${item.produto.descricao}">Arroz</td>
                <td th:text="'R$ ' + ${item.valor}">R$ 10.00</td>
                <td th:text="${item.quantidade}">1.0</td>
                <td th:text="'R$ ' + ${item.total()}">R$ 10.00</td>
                <td>
                    <a th:href="@{/venda/remove/{index}(index=${stat.index})}"
                       class="btn btn-danger btn-sm">Remover</a>
                </td>
            </tr>

            <tr th:if="${venda.itemVendas.isEmpty()}">
                <td colspan="5" class="text-center">Seu carrinho está vazio.</td>
            </tr>
            </tbody>
            <tfoot>
            <tr class="table-secondary">
                <td colspan="3" class="text-end fw-bold">TOTAL GERAL:</td>
                <td class="fw-bold fs-5 text-success" th:text="'R$ ' + ${venda.total()}">R$ 0.00</td>
                <td></td>
            </tr>
            </tfoot>
        </table>

        <hr>

        <div class="card p-4 bg-light" th:if="${!venda.itemVendas.isEmpty()}">
            <h4>Finalizar Compra</h4>
            <form th:action="@{/venda/finalizar}" method="POST">

                <div class="mb-3">
                    <label for="cliente" class="form-label">Selecione o Cliente:</label>
                    <select name="clienteId" id="cliente" class="form-select" required>
                        <option value="">-- Escolha um Cliente --</option>
                        <option th:each="c : ${clientes}"
                                th:value="${c.id}"
                                th:text="${c.getNomeCliente()}"></option>
                    </select>
                </div>

                <div class="d-grid gap-2">
                    <button type="submit" class="btn btn-success btn-lg">Concluir Pedido</button>
                </div>
            </form>
        </div>

        <div class="mt-3">
            <a th:href="@{/produto/home}" class="btn btn-outline-primary">Continuar Comprando</a>
        </div>

    </div>
</main>
</html>